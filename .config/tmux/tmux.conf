# tmuxã‚’256è‰²è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ (true colorå¯¾å¿œ)
set-option -g default-terminal "tmux-256color"
set-option -sa terminal-overrides ",xterm*:Tc"

# prefixã‚­ãƒ¼ã‚’C-tã«å¤‰æ›´
set -g prefix C-t

# C-bã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚’è§£é™¤
unbind C-b

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã‚’ãƒœãƒˆãƒ ã«é…ç½®
set-option -g status-position bottom

# vimã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã§ãƒšã‚¤ãƒ³ã‚’ç§»å‹•ã™ã‚‹
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# vimã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã§ãƒšã‚¤ãƒ³ã‚’ãƒªã‚µã‚¤ã‚ºã™ã‚‹
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# | ã§ãƒšã‚¤ãƒ³ã‚’ç¸¦åˆ†å‰²ã™ã‚‹
bind | split-window -h

# - ã§ãƒšã‚¤ãƒ³ã‚’æ¨ªåˆ†å‰²ã™ã‚‹
bind - split-window -v

# ç•ªå·åŸºæº–å€¤ã‚’å¤‰æ›´
set-option -g base-index 1

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦åã‚’ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã«è‡ªå‹•è¨­å®š
set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'

# ãƒã‚¦ã‚¹æ“ä½œã‚’æœ‰åŠ¹ã«ã™ã‚‹
set-option -g mouse on
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'copy-mode -e'"

# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹
## viã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚’ä½¿ç”¨
setw -g mode-keys vi

# macOS clipboard integration
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"

# popup ã§ghq/gwqå‘¼ã³å‡ºã—ï¼ˆtmux 3.2+ï¼‰
bind g display-popup -w 90% -h 90% -E "zsh -ic 'ghq-tmux'"
bind w display-popup -w 90% -h 90% -E "zsh -ic 'gwq-tmux'"
bind s display-popup -w 90% -h 90% -E "zsh -ic 'tmux-session-fzf'"

# Pokemon (æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆæ™‚ã«ãƒ©ãƒ³ãƒ€ãƒ è¡¨ç¤º)
set-hook -g session-created 'run-shell "/opt/homebrew/bin/pokemon-go-colorscripts -r -s"'

# ===========================================
# Plugins (TPM)
# ===========================================

# Catppuccin theme (Ghosttyã¨çµ±ä¸€)
set -g @plugin 'catppuccin/tmux#v2.1.3'
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_status_style 'rounded'

# tmux-battery (Catppuccin ã®ãƒãƒƒãƒ†ãƒªãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¿…è¦)
set -g @plugin 'tmux-plugins/tmux-battery'

# tmux-cpu (CPU/ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡è¡¨ç¤º)
set -g @plugin 'tmux-plugins/tmux-cpu'

# TPM (Tmux Plugin Manager)
set -g @plugin 'tmux-plugins/tpm'

# Catppuccin battery ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š
# å……é›»ä¸­: âš¡ / æ”¾é›»ä¸­: ğŸ”‹
set -g @catppuccin_battery_icon "#(pmset -g batt | grep -q 'AC Power' && echo 'âš¡' || echo 'ğŸ”‹') "
set -g @catppuccin_battery_text " #(~/.tmux/plugins/tmux-battery/scripts/battery_percentage.sh)"

# Catppuccin ãƒ†ãƒ¼ãƒã‚’ãƒ­ãƒ¼ãƒ‰ (status module è¨­å®šã®å‰ã«å¿…è¦)
# PATH ã‚’è¨­å®šã—ã¦ /usr/bin/env bash ãŒå‹•ä½œã™ã‚‹ã‚ˆã†ã«ã™ã‚‹
run-shell "if [ -f ~/.tmux/plugins/tmux/catppuccin.tmux ]; then PATH=/opt/homebrew/bin:$PATH ~/.tmux/plugins/tmux/catppuccin.tmux; fi"

# Catppuccin ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰
source-file ~/.tmux/plugins/tmux/status/session.conf
source-file ~/.tmux/plugins/tmux/status/battery.conf
source-file ~/.tmux/plugins/tmux/status/date_time.conf

# Status line è¨­å®š (Catppuccin v2 å½¢å¼)
set -g status-right-length 150
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_session}"
set -ga status-right "#[bg=#313244]#(/opt/homebrew/bin/gitmux -cfg ~/.config/gitmux/config.yml '#{pane_current_path}') "
set -ga status-right "#[bg=#313244,fg=#89b4fa] C:#(~/.tmux/plugins/tmux-cpu/scripts/cpu_percentage.sh) #[fg=#a6e3a1]M:#(~/.tmux/plugins/tmux-cpu/scripts/ram_percentage.sh) "
set -ga status-right "#{E:@catppuccin_status_battery}"
set -ga status-right "#{E:@catppuccin_status_date_time}"

# TPMã‚’æœ€å¾Œã«å®Ÿè¡Œ
run-shell "PATH=/opt/homebrew/bin:$PATH $HOME/.tmux/plugins/tpm/tpm"
